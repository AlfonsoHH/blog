"use strict";

var RESPONSES = {
	'nodes-ui': {
		"id": 49415326,
		"name": "nodes-ui",
		"full_name": "nodes-frontend/nodes-ui",
		"owner": {
			"login": "nodes-frontend",
			"id": 12171921,
			"avatar_url": "https://avatars.githubusercontent.com/u/12171921?v=3",
			"gravatar_id": "",
			"url": "https://api.github.com/users/nodes-frontend",
			"html_url": "https://github.com/nodes-frontend",
			"followers_url": "https://api.github.com/users/nodes-frontend/followers",
			"following_url": "https://api.github.com/users/nodes-frontend/following{/other_user}",
			"gists_url": "https://api.github.com/users/nodes-frontend/gists{/gist_id}",
			"starred_url": "https://api.github.com/users/nodes-frontend/starred{/owner}{/repo}",
			"subscriptions_url": "https://api.github.com/users/nodes-frontend/subscriptions",
			"organizations_url": "https://api.github.com/users/nodes-frontend/orgs",
			"repos_url": "https://api.github.com/users/nodes-frontend/repos",
			"events_url": "https://api.github.com/users/nodes-frontend/events{/privacy}",
			"received_events_url": "https://api.github.com/users/nodes-frontend/received_events",
			"type": "Organization",
			"site_admin": false
		},
		"private": false,
		"html_url": "https://github.com/nodes-frontend/nodes-ui",
		"description": "UI Components for Nodes Backends",
		"fork": false,
		"url": "https://api.github.com/repos/nodes-frontend/nodes-ui",
		"forks_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/forks",
		"keys_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/keys{/key_id}",
		"collaborators_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/collaborators{/collaborator}",
		"teams_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/teams",
		"hooks_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/hooks",
		"issue_events_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/issues/events{/number}",
		"events_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/events",
		"assignees_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/assignees{/user}",
		"branches_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/branches{/branch}",
		"tags_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/tags",
		"blobs_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/git/blobs{/sha}",
		"git_tags_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/git/tags{/sha}",
		"git_refs_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/git/refs{/sha}",
		"trees_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/git/trees{/sha}",
		"statuses_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/statuses/{sha}",
		"languages_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/languages",
		"stargazers_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/stargazers",
		"contributors_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/contributors",
		"subscribers_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/subscribers",
		"subscription_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/subscription",
		"commits_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/commits{/sha}",
		"git_commits_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/git/commits{/sha}",
		"comments_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/comments{/number}",
		"issue_comment_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/issues/comments{/number}",
		"contents_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/contents/{+path}",
		"compare_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/compare/{base}...{head}",
		"merges_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/merges",
		"archive_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/{archive_format}{/ref}",
		"downloads_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/downloads",
		"issues_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/issues{/number}",
		"pulls_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/pulls{/number}",
		"milestones_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/milestones{/number}",
		"notifications_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/notifications{?since,all,participating}",
		"labels_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/labels{/name}",
		"releases_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/releases{/id}",
		"deployments_url": "https://api.github.com/repos/nodes-frontend/nodes-ui/deployments",
		"created_at": "2016-01-11T09:23:30Z",
		"updated_at": "2016-05-18T14:28:31Z",
		"pushed_at": "2016-07-14T12:01:38Z",
		"git_url": "git://github.com/nodes-frontend/nodes-ui.git",
		"ssh_url": "git@github.com:nodes-frontend/nodes-ui.git",
		"clone_url": "https://github.com/nodes-frontend/nodes-ui.git",
		"svn_url": "https://github.com/nodes-frontend/nodes-ui",
		"homepage": "https://nodes-frontend.github.io/nodes-ui",
		"size": 1788,
		"stargazers_count": 1,
		"watchers_count": 1,
		"language": "CSS",
		"has_issues": true,
		"has_downloads": true,
		"has_wiki": true,
		"has_pages": true,
		"forks_count": 0,
		"mirror_url": null,
		"open_issues_count": 2,
		"forks": 0,
		"open_issues": 2,
		"watchers": 1,
		"default_branch": "master",
		"organization": {
			"login": "nodes-frontend",
			"id": 12171921,
			"avatar_url": "https://avatars.githubusercontent.com/u/12171921?v=3",
			"gravatar_id": "",
			"url": "https://api.github.com/users/nodes-frontend",
			"html_url": "https://github.com/nodes-frontend",
			"followers_url": "https://api.github.com/users/nodes-frontend/followers",
			"following_url": "https://api.github.com/users/nodes-frontend/following{/other_user}",
			"gists_url": "https://api.github.com/users/nodes-frontend/gists{/gist_id}",
			"starred_url": "https://api.github.com/users/nodes-frontend/starred{/owner}{/repo}",
			"subscriptions_url": "https://api.github.com/users/nodes-frontend/subscriptions",
			"organizations_url": "https://api.github.com/users/nodes-frontend/orgs",
			"repos_url": "https://api.github.com/users/nodes-frontend/repos",
			"events_url": "https://api.github.com/users/nodes-frontend/events{/privacy}",
			"received_events_url": "https://api.github.com/users/nodes-frontend/received_events",
			"type": "Organization",
			"site_admin": false
		},
		"network_count": 0,
		"subscribers_count": 5
	},
	'generator-nodes': {
		"id"               : 48735268,
		"name"             : "generator-nodes",
		"full_name"        : "nodes-frontend/generator-nodes",
		"owner"            : {
			"login"              : "nodes-frontend",
			"id"                 : 12171921,
			"avatar_url"         : "https://avatars.githubusercontent.com/u/12171921?v=3",
			"gravatar_id"        : "",
			"url"                : "https://api.github.com/users/nodes-frontend",
			"html_url"           : "https://github.com/nodes-frontend",
			"followers_url"      : "https://api.github.com/users/nodes-frontend/followers",
			"following_url"      : "https://api.github.com/users/nodes-frontend/following{/other_user}",
			"gists_url"          : "https://api.github.com/users/nodes-frontend/gists{/gist_id}",
			"starred_url"        : "https://api.github.com/users/nodes-frontend/starred{/owner}{/repo}",
			"subscriptions_url"  : "https://api.github.com/users/nodes-frontend/subscriptions",
			"organizations_url"  : "https://api.github.com/users/nodes-frontend/orgs",
			"repos_url"          : "https://api.github.com/users/nodes-frontend/repos",
			"events_url"         : "https://api.github.com/users/nodes-frontend/events{/privacy}",
			"received_events_url": "https://api.github.com/users/nodes-frontend/received_events",
			"type"               : "Organization",
			"site_admin"         : false
		},
		"private"          : false,
		"html_url"         : "https://github.com/nodes-frontend/generator-nodes",
		"description"      : "",
		"fork"             : false,
		"url"              : "https://api.github.com/repos/nodes-frontend/generator-nodes",
		"forks_url"        : "https://api.github.com/repos/nodes-frontend/generator-nodes/forks",
		"keys_url"         : "https://api.github.com/repos/nodes-frontend/generator-nodes/keys{/key_id}",
		"collaborators_url": "https://api.github.com/repos/nodes-frontend/generator-nodes/collaborators{/collaborator}",
		"teams_url"        : "https://api.github.com/repos/nodes-frontend/generator-nodes/teams",
		"hooks_url"        : "https://api.github.com/repos/nodes-frontend/generator-nodes/hooks",
		"issue_events_url" : "https://api.github.com/repos/nodes-frontend/generator-nodes/issues/events{/number}",
		"events_url"       : "https://api.github.com/repos/nodes-frontend/generator-nodes/events",
		"assignees_url"    : "https://api.github.com/repos/nodes-frontend/generator-nodes/assignees{/user}",
		"branches_url"     : "https://api.github.com/repos/nodes-frontend/generator-nodes/branches{/branch}",
		"tags_url"         : "https://api.github.com/repos/nodes-frontend/generator-nodes/tags",
		"blobs_url"        : "https://api.github.com/repos/nodes-frontend/generator-nodes/git/blobs{/sha}",
		"git_tags_url"     : "https://api.github.com/repos/nodes-frontend/generator-nodes/git/tags{/sha}",
		"git_refs_url"     : "https://api.github.com/repos/nodes-frontend/generator-nodes/git/refs{/sha}",
		"trees_url"        : "https://api.github.com/repos/nodes-frontend/generator-nodes/git/trees{/sha}",
		"statuses_url"     : "https://api.github.com/repos/nodes-frontend/generator-nodes/statuses/{sha}",
		"languages_url"    : "https://api.github.com/repos/nodes-frontend/generator-nodes/languages",
		"stargazers_url"   : "https://api.github.com/repos/nodes-frontend/generator-nodes/stargazers",
		"contributors_url" : "https://api.github.com/repos/nodes-frontend/generator-nodes/contributors",
		"subscribers_url"  : "https://api.github.com/repos/nodes-frontend/generator-nodes/subscribers",
		"subscription_url" : "https://api.github.com/repos/nodes-frontend/generator-nodes/subscription",
		"commits_url"      : "https://api.github.com/repos/nodes-frontend/generator-nodes/commits{/sha}",
		"git_commits_url"  : "https://api.github.com/repos/nodes-frontend/generator-nodes/git/commits{/sha}",
		"comments_url"     : "https://api.github.com/repos/nodes-frontend/generator-nodes/comments{/number}",
		"issue_comment_url": "https://api.github.com/repos/nodes-frontend/generator-nodes/issues/comments{/number}",
		"contents_url"     : "https://api.github.com/repos/nodes-frontend/generator-nodes/contents/{+path}",
		"compare_url"      : "https://api.github.com/repos/nodes-frontend/generator-nodes/compare/{base}...{head}",
		"merges_url"       : "https://api.github.com/repos/nodes-frontend/generator-nodes/merges",
		"archive_url"      : "https://api.github.com/repos/nodes-frontend/generator-nodes/{archive_format}{/ref}",
		"downloads_url"    : "https://api.github.com/repos/nodes-frontend/generator-nodes/downloads",
		"issues_url"       : "https://api.github.com/repos/nodes-frontend/generator-nodes/issues{/number}",
		"pulls_url"        : "https://api.github.com/repos/nodes-frontend/generator-nodes/pulls{/number}",
		"milestones_url"   : "https://api.github.com/repos/nodes-frontend/generator-nodes/milestones{/number}",
		"notifications_url": "https://api.github.com/repos/nodes-frontend/generator-nodes/notifications{?since,all,participating}",
		"labels_url"       : "https://api.github.com/repos/nodes-frontend/generator-nodes/labels{/name}",
		"releases_url"     : "https://api.github.com/repos/nodes-frontend/generator-nodes/releases{/id}",
		"deployments_url"  : "https://api.github.com/repos/nodes-frontend/generator-nodes/deployments",
		"created_at"       : "2015-12-29T07:49:01Z",
		"updated_at"       : "2016-01-21T09:46:58Z",
		"pushed_at"        : "2016-05-10T06:59:38Z",
		"git_url"          : "git://github.com/nodes-frontend/generator-nodes.git",
		"ssh_url"          : "git@github.com:nodes-frontend/generator-nodes.git",
		"clone_url"        : "https://github.com/nodes-frontend/generator-nodes.git",
		"svn_url"          : "https://github.com/nodes-frontend/generator-nodes",
		"homepage"         : null,
		"size"             : 680,
		"stargazers_count" : 0,
		"watchers_count"   : 0,
		"language"         : "JavaScript",
		"has_issues"       : true,
		"has_downloads"    : true,
		"has_wiki"         : true,
		"has_pages"        : false,
		"forks_count"      : 0,
		"mirror_url"       : null,
		"open_issues_count": 0,
		"forks"            : 0,
		"open_issues"      : 0,
		"watchers"         : 0,
		"default_branch"   : "master",
		"organization"     : {
			"login"              : "nodes-frontend",
			"id"                 : 12171921,
			"avatar_url"         : "https://avatars.githubusercontent.com/u/12171921?v=3",
			"gravatar_id"        : "",
			"url"                : "https://api.github.com/users/nodes-frontend",
			"html_url"           : "https://github.com/nodes-frontend",
			"followers_url"      : "https://api.github.com/users/nodes-frontend/followers",
			"following_url"      : "https://api.github.com/users/nodes-frontend/following{/other_user}",
			"gists_url"          : "https://api.github.com/users/nodes-frontend/gists{/gist_id}",
			"starred_url"        : "https://api.github.com/users/nodes-frontend/starred{/owner}{/repo}",
			"subscriptions_url"  : "https://api.github.com/users/nodes-frontend/subscriptions",
			"organizations_url"  : "https://api.github.com/users/nodes-frontend/orgs",
			"repos_url"          : "https://api.github.com/users/nodes-frontend/repos",
			"events_url"         : "https://api.github.com/users/nodes-frontend/events{/privacy}",
			"received_events_url": "https://api.github.com/users/nodes-frontend/received_events",
			"type"               : "Organization",
			"site_admin"         : false
		},
		"network_count"    : 0,
		"subscribers_count": 4
	}
};

(function() {
	// Remove the no-js tag from the html node if we do support javascript.
	document.querySelector('html').classList.remove('no-js');
})();

jQuery(document).ready(function($) {
	
	var $articleBackButton = $('.article-header__back-button');
	if($articleBackButton.length > 0) {
		$articleBackButton.on('click', _browserHistoryBack);
	}
	
	var $mobileNavigationToggle = $('.page-header__mobile-toggle button');
	if($mobileNavigationToggle.length > 0) {
		$mobileNavigationToggle.on('click', _toggleMobileNavigation);
	}
	
	$('[data-github-repo]').each(function() {
		
		var $this = $(this);
		
		var languages = $this.data('github-languages').split(',');
		
		for(var i = 0, l = languages.length; i < l; i++) {
			var iconClass = 'devicon-' + languages[i] + '-plain';
			$this.find('.repo__languages').append('<i class="repo__language-icon ' + iconClass + '"></i>');
		}
		
		var results = RESPONSES[$this.data('github-repo')];
		$this.find('.repo__stars-out').text(results.stargazers_count);
		// _getRepositoryStatistics($this.data('github-org'), $this.data('github-repo'))
		// 	.then(function(results) {
		// 		console.log(results);
		// 		$this.find('.repo__stars').text('Stars: ' + results.stargazers_count);
		// 	});
	});
	
	/**
	 * Go back 1 time in browser history, if supported
	 * @private
	 */
	function _browserHistoryBack(e) {
		if(!window.history || !history) {
			return;
		}
		
		e.preventDefault();
		
		window.history.back();
	}
	
	function _toggleMobileNavigation() {
		var navWrapper = document.querySelector('.page-header__navigation');
		var nav = document.querySelector('.navigation');
		var coords = _getComputedStyle(nav);
		
		this.classList.toggle('page-header__mobile-toggle--open');
		this.classList.toggle('is-active');
		
		var isOpen = this.classList.contains('page-header__mobile-toggle--open');
		
		navWrapper.style.height = (isOpen) ? coords.height : 0;
		
	}
	
	function _getComputedStyle(el) {
		return window.getComputedStyle(el);
	}
	
	function _getRepositoryStatistics(organization, repository) {
		
		// var url = [
		// 	'https://statistics.like.st/api/github',
		// 	repository
		// ].join('/');
		var url = [
			'https://api.github.com',
			'repos',
			organization,
			repository
		].join('/');
		
		return $.get(url);
		
	}
});